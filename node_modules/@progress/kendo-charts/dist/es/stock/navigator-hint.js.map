{"version":3,"file":"navigator-hint.js","sources":["navigator-hint.js"],"sourcesContent":["import { Class, deepExtend, elementStyles, getTemplate, setDefaultOptions } from '../common';\nimport { toDate, toTime } from '../date-utils';\nimport FadeOutAnimation from './fade-out-animation';\n\nfunction createDiv(className, style) {\n    const div = document.createElement(\"div\");\n    div.className = className;\n    if (style) {\n        div.style.cssText = style;\n    }\n\n    return div;\n}\n\nclass NavigatorHint extends Class {\n    constructor(container, chartService, options) {\n        super();\n\n        this.options = deepExtend({}, this.options, options);\n        this.container = container;\n        this.chartService = chartService;\n\n        const padding = elementStyles(container, [ \"paddingLeft\", \"paddingTop\" ]);\n        this.chartPadding = {\n            top: padding.paddingTop,\n            left: padding.paddingLeft\n        };\n\n        this.createElements();\n        container.appendChild(this.element);\n    }\n\n    createElements() {\n        const element = this.element = createDiv('k-navigator-hint', 'display: none; position: absolute; top: 1px; left: 1px;');\n        const tooltip = this.tooltip = createDiv('k-tooltip k-chart-tooltip');\n        const scroll = this.scroll = createDiv('k-scroll');\n\n        tooltip.innerHTML = '&nbsp;';\n\n        element.appendChild(tooltip);\n        element.appendChild(scroll);\n    }\n\n    show(from, to, bbox) {\n        const { element, options, scroll, tooltip } = this;\n        const middle = toDate(toTime(from) + toTime(to - from) / 2);\n        const scrollWidth = bbox.width() * 0.4;\n        const minPos = bbox.center().x - scrollWidth;\n        const maxPos = bbox.center().x;\n        const posRange = maxPos - minPos;\n        const range = options.max - options.min;\n        const scale = posRange / range;\n        const offset = middle - options.min;\n        let text = this.chartService.intl.format(options.format, from, to);\n        const template = getTemplate(options);\n\n        this.clearHideTimeout();\n\n        if (!this._visible) {\n            elementStyles(element, {\n                visibility: 'hidden',\n                display: 'block'\n            });\n            this._visible = true;\n        }\n\n        if (template) {\n            text = template({\n                from: from,\n                to: to\n            });\n        }\n\n        tooltip.innerHTML = text;\n        elementStyles(tooltip, {\n            left: bbox.center().x - tooltip.offsetWidth / 2,\n            top: bbox.y1\n        });\n\n        const tooltipStyle = elementStyles(tooltip, [ 'marginTop', 'borderTopWidth', 'height' ]);\n\n        elementStyles(scroll, {\n            width: scrollWidth,\n            left: minPos + offset * scale,\n            top: bbox.y1 + tooltipStyle.marginTop + tooltipStyle.borderTopWidth + tooltipStyle.height / 2\n        });\n\n        elementStyles(element, {\n            visibility: 'visible'\n        });\n    }\n\n    clearHideTimeout() {\n        if (this._hideTimeout) {\n            clearTimeout(this._hideTimeout);\n        }\n\n        if (this._hideAnimation) {\n            this._hideAnimation.cancel();\n        }\n    }\n\n    hide() {\n        this.clearHideTimeout();\n\n        this._hideTimeout = setTimeout(() => {\n            this._visible = false;\n            this._hideAnimation = new FadeOutAnimation(this.element);\n            this._hideAnimation.setup();\n            this._hideAnimation.play();\n        }, this.options.hideDelay);\n    }\n\n    destroy() {\n        this.clearHideTimeout();\n        if (this.container) {\n            this.container.removeChild(this.element);\n        }\n        delete this.container;\n        delete this.chartService;\n        delete this.element;\n        delete this.tooltip;\n        delete this.scroll;\n    }\n}\n\nsetDefaultOptions(NavigatorHint, {\n    format: \"{0:d} - {1:d}\",\n    hideDelay: 500\n});\n\nexport default NavigatorHint;"],"names":["const","super","let","this"],"mappings":"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"}