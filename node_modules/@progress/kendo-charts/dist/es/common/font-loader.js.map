{"version":3,"file":"font-loader.js","sources":["font-loader.js"],"sourcesContent":["import { logToConsole } from '../drawing-utils';\n\nclass FontLoader {\n    static fetchFonts(options, fonts, state = { depth: 0 }) {\n        const MAX_DEPTH = 5;\n\n        if (!options || state.depth > MAX_DEPTH || !document.fonts) {\n            return;\n        }\n\n        Object.keys(options).forEach(function(key) {\n            const value = options[key];\n            if (key === \"dataSource\" || key[0] === \"$\" || !value) {\n                return;\n            }\n\n            if (key === \"font\") {\n                fonts.push(value);\n            } else if (typeof value === \"object\") {\n                state.depth++;\n                FontLoader.fetchFonts(value, fonts, state);\n                state.depth--;\n            }\n        });\n    }\n\n    static loadFonts(fonts, callback) {\n        let promises = [];\n\n        if (fonts.length > 0 && document.fonts) {\n            try {\n                promises = fonts.map(function(font) {\n                    return document.fonts.load(font);\n                });\n            } catch (e) {\n                // Silence font-loading errors\n                logToConsole(e);\n            }\n\n            Promise.all(promises).then(callback, callback);\n        } else {\n            callback();\n        }\n    }\n\n    static preloadFonts(options, callback) {\n        const fonts = [];\n        FontLoader.fetchFonts(options, fonts);\n\n        FontLoader.loadFonts(fonts, callback);\n    }\n}\n\nexport default FontLoader;"],"names":["const","let"],"mappings":"AAAA,SAAS,YAAY,QAAQ,kBAAkB,CAAC;;AAEhD,IAAM,UAAU,GAAC;;AAAA,AACjB,AAAI,WAAA,AAAO,UAAU,uBAAA,CAAC,OAAO,EAAE,KAAK,EAAE,KAAoB,EAAE,CAAjB;qCAAA,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE;AAAG;IACzD,AAAIA,GAAK,CAAC,SAAS,GAAG,CAAC,CAAC;;IAExB,AAAI,IAAI,CAAC,OAAO,IAAI,KAAK,CAAC,KAAK,GAAG,SAAS,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;QAC5D,AAAI,OAAO;IACf,AAAI,CAAC;;IAEL,AAAI,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE;QAC3C,AAAIA,GAAK,CAAC,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;QAC/B,AAAI,IAAI,GAAG,KAAK,YAAY,IAAI,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE;YACtD,AAAI,OAAO;QACf,AAAI,CAAC;;QAEL,AAAI,IAAI,GAAG,KAAK,MAAM,EAAE;YACpB,AAAI,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC1B,AAAI,CAAC,MAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YACtC,AAAI,KAAK,CAAC,KAAK,EAAE,CAAC;YAClB,AAAI,UAAU,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;YAC/C,AAAI,KAAK,CAAC,KAAK,EAAE,CAAC;QACtB,AAAI,CAAC;IACT,AAAI,CAAC,CAAC,CAAC;AACX,AAAI,CAAC,CAAA;;AAEL,AAAI,WAAA,AAAO,SAAS,sBAAA,CAAC,KAAK,EAAE,QAAQ,EAAE;IAClC,AAAIC,GAAG,CAAC,QAAQ,GAAG,EAAE,CAAC;;IAEtB,AAAI,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,QAAQ,CAAC,KAAK,EAAE;QACxC,AAAI,IAAI;YACJ,AAAI,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,SAAS,IAAI,EAAE;gBACpC,AAAI,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACzC,AAAI,CAAC,CAAC,CAAC;QACX,AAAI,CAAC,CAAC,OAAO,CAAC,EAAE;YACZ,AAAI;YACJ,AAAI,YAAY,CAAC,CAAC,CAAC,CAAC;QACxB,AAAI,CAAC;;QAEL,AAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;IACvD,AAAI,CAAC,MAAM;QACP,AAAI,QAAQ,EAAE,CAAC;IACnB,AAAI,CAAC;AACT,AAAI,CAAC,CAAA;;AAEL,AAAI,WAAA,AAAO,YAAY,yBAAA,CAAC,OAAO,EAAE,QAAQ,EAAE;IACvC,AAAID,GAAK,CAAC,KAAK,GAAG,EAAE,CAAC;IACrB,AAAI,UAAU,CAAC,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;;IAE1C,AAAI,UAAU,CAAC,SAAS,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC9C,AAAI,CAAC,CAAA,AACJ;;AAED,eAAe,UAAU"}