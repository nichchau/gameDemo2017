{"version":3,"file":"eval-options.js","sources":["eval-options.js"],"sourcesContent":["import { inArray, isFunction, isObject, valueOrDefault } from '../../common';\n\nconst MAX_EXPAND_DEPTH = 5;\n\nexport default function evalOptions(options, context, state = {}, dryRun = false) {\n    const defaults = state.defaults = state.defaults || {};\n    const depth = state.depth = state.depth || 0;\n    let needsEval = false;\n\n    state.excluded = state.excluded || [];\n\n    if (depth > MAX_EXPAND_DEPTH) {\n        return null;\n    }\n\n    for (let property in options) {\n        if (!inArray(property, state.excluded) && options.hasOwnProperty(property)) {\n            const propValue = options[property];\n            if (isFunction(propValue)) {\n                needsEval = true;\n                if (!dryRun) {\n                    options[property] = valueOrDefault(propValue(context), defaults[property]);\n                }\n            } else if (isObject(propValue)) {\n                if (!dryRun) {\n                    state.defaults = defaults[property];\n                }\n                state.depth++;\n                needsEval = evalOptions(propValue, context, state, dryRun) || needsEval;\n                state.depth--;\n            }\n        }\n    }\n\n    return needsEval;\n}"],"names":["const","let"],"mappings":"AAAA,SAAS,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,cAAc,QAAQ,cAAc,CAAC;;AAE7EA,GAAK,CAAC,gBAAgB,GAAG,CAAC,CAAC;;AAE3B,eAAe,SAAS,WAAW,CAAC,OAAO,EAAE,OAAO,EAAE,KAAU,EAAE,MAAc,EAAE,CAAvB;iCAAA,GAAG,EAAE,CAAQ;mCAAA,GAAG,KAAK;AAAG;IAC/EA,GAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,IAAI,EAAE,CAAC;IACvDA,GAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,IAAI,CAAC,CAAC;IAC7CC,GAAG,CAAC,SAAS,GAAG,KAAK,CAAC;;IAEtB,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,IAAI,EAAE,CAAC;;IAEtC,IAAI,KAAK,GAAG,gBAAgB,EAAE;QAC1B,OAAO,IAAI,CAAC;KACf;;IAED,KAAKA,GAAG,CAAC,QAAQ,IAAI,OAAO,EAAE;QAC1B,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,OAAO,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;YACxED,GAAK,CAAC,SAAS,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;YACpC,IAAI,UAAU,CAAC,SAAS,CAAC,EAAE;gBACvB,SAAS,GAAG,IAAI,CAAC;gBACjB,IAAI,CAAC,MAAM,EAAE;oBACT,OAAO,CAAC,QAAQ,CAAC,GAAG,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;iBAC9E;aACJ,MAAM,IAAI,QAAQ,CAAC,SAAS,CAAC,EAAE;gBAC5B,IAAI,CAAC,MAAM,EAAE;oBACT,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;iBACvC;gBACD,KAAK,CAAC,KAAK,EAAE,CAAC;gBACd,SAAS,GAAG,WAAW,CAAC,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,IAAI,SAAS,CAAC;gBACxE,KAAK,CAAC,KAAK,EAAE,CAAC;aACjB;SACJ;KACJ;;IAED,OAAO,SAAS,CAAC;"}