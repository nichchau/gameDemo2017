{"version":3,"file":"bullet.js","sources":["bullet.js"],"sourcesContent":["import { drawing as draw } from '@progress/kendo-drawing';\n\nimport Target from './target';\n\nimport { ChartElement, Box } from '../../core';\n\nimport PointEventsMixin from '../mixins/point-events-mixin';\nimport NoteMixin from '../mixins/note-mixin';\nimport Bar from '../bar-chart/bar';\n\nimport { WHITE, TOP, RIGHT } from '../../common/constants';\nimport { alignPathToPixel, deepExtend, defined, setDefaultOptions, valueOrDefault } from '../../common';\n\nclass Bullet extends ChartElement {\n    constructor(value, options) {\n        super(options);\n\n        this.aboveAxis = this.options.aboveAxis;\n        this.color = options.color || WHITE;\n        this.value = value;\n    }\n\n    render() {\n        const options = this.options;\n\n        if (!this._rendered) {\n            this._rendered = true;\n\n            if (defined(this.value.target)) {\n                this.target = new Target({\n                    type: options.target.shape,\n                    background: options.target.color || this.color,\n                    opacity: options.opacity,\n                    zIndex: options.zIndex,\n                    border: options.target.border,\n                    vAlign: TOP,\n                    align: RIGHT\n                });\n\n                this.target.value = this.value;\n                this.target.dataItem = this.dataItem;\n                this.target.series = this.series;\n\n                this.append(this.target);\n            }\n\n            this.createNote();\n        }\n    }\n\n    reflow(box) {\n        this.render();\n\n        const { options, target, owner: chart } = this;\n        const invertAxes = options.invertAxes;\n        const valueAxis = chart.seriesValueAxis(this.options);\n        const categorySlot = chart.categorySlot(chart.categoryAxis, options.categoryIx, valueAxis);\n        const targetValueSlot = valueAxis.getSlot(this.value.target);\n        const targetSlotX = invertAxes ? targetValueSlot : categorySlot;\n        const targetSlotY = invertAxes ? categorySlot : targetValueSlot;\n\n        if (target) {\n            const targetSlot = new Box(\n                targetSlotX.x1, targetSlotY.y1,\n                targetSlotX.x2, targetSlotY.y2\n            );\n            target.options.height = invertAxes ? targetSlot.height() : options.target.line.width;\n            target.options.width = invertAxes ? options.target.line.width : targetSlot.width();\n            target.reflow(targetSlot);\n        }\n\n        if (this.note) {\n            this.note.reflow(box);\n        }\n\n        this.box = box;\n    }\n\n    createVisual() {\n        super.createVisual();\n\n        const options = this.options;\n        const body = draw.Path.fromRect(this.box.toRect(), {\n            fill: {\n                color: this.color,\n                opacity: options.opacity\n            },\n            stroke: null\n        });\n\n        if (options.border.width > 0) {\n            body.options.set(\"stroke\", {\n                color: options.border.color || this.color,\n                width: options.border.width,\n                dashType: options.border.dashType,\n                opacity: valueOrDefault(options.border.opacity, options.opacity)\n            });\n        }\n\n        this.bodyVisual = body;\n\n        alignPathToPixel(body);\n        this.visual.append(body);\n    }\n\n    createAnimation() {\n        if (this.bodyVisual) {\n            this.animation = draw.Animation.create(\n                this.bodyVisual, this.options.animation\n            );\n        }\n    }\n\n    createHighlight(style) {\n        return draw.Path.fromRect(this.box.toRect(), style);\n    }\n\n    highlightVisual() {\n        return this.bodyVisual;\n    }\n\n    highlightVisualArgs() {\n        return {\n            rect: this.box.toRect(),\n            visual: this.bodyVisual,\n            options: this.options\n        };\n    }\n\n    formatValue(format) {\n        return this.owner.formatPointValue(this, format);\n    }\n}\n\nBullet.prototype.tooltipAnchor = Bar.prototype.tooltipAnchor;\n\nsetDefaultOptions(Bullet, {\n    border: {\n        width: 1\n    },\n    vertical: false,\n    opacity: 1,\n    target: {\n        shape: \"\",\n        border: {\n            width: 0,\n            color: \"green\"\n        },\n        line: {\n            width: 2\n        }\n    },\n    tooltip: {\n        format: \"Current: {0}<br />Target: {1}\"\n    }\n});\n\ndeepExtend(Bullet.prototype, PointEventsMixin);\ndeepExtend(Bullet.prototype, NoteMixin);\n\nexport default Bullet;"],"names":["super","const"],"mappings":"AAAA,SAAS,OAAO,IAAI,IAAI,QAAQ,yBAAyB,CAAC;;AAE1D,OAAO,MAAM,MAAM,UAAU,CAAC;;AAE9B,SAAS,YAAY,EAAE,GAAG,QAAQ,YAAY,CAAC;;AAE/C,OAAO,gBAAgB,MAAM,8BAA8B,CAAC;AAC5D,OAAO,SAAS,MAAM,sBAAsB,CAAC;AAC7C,OAAO,GAAG,MAAM,kBAAkB,CAAC;;AAEnC,SAAS,KAAK,EAAE,GAAG,EAAE,KAAK,QAAQ,wBAAwB,CAAC;AAC3D,SAAS,gBAAgB,EAAE,UAAU,EAAE,OAAO,EAAE,iBAAiB,EAAE,cAAc,QAAQ,cAAc,CAAC;;AAExG,IAAM,MAAM,GAAqB;IAAC,AAC9B,eAAW,CAAC,KAAK,EAAE,OAAO,EAAE;QACxBA,YAAK,KAAA,CAAC,MAAA,OAAO,CAAC,CAAC;;QAEf,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;QACxC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,KAAK,CAAC;QACpC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;KACtB;;;;0CAAA;;IAED,iBAAA,MAAM,mBAAA,GAAG;QACLC,GAAK,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;;QAE7B,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACjB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;;YAEtB,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;gBAC5B,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC;oBACrB,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK;oBAC1B,UAAU,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK;oBAC9C,OAAO,EAAE,OAAO,CAAC,OAAO;oBACxB,MAAM,EAAE,OAAO,CAAC,MAAM;oBACtB,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM;oBAC7B,MAAM,EAAE,GAAG;oBACX,KAAK,EAAE,KAAK;iBACf,CAAC,CAAC;;gBAEH,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;gBAC/B,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;gBACrC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;;gBAEjC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAC5B;;YAED,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;KACJ,CAAA;;IAED,iBAAA,MAAM,mBAAA,CAAC,GAAG,EAAE;QACR,IAAI,CAAC,MAAM,EAAE,CAAC;;QAEd,AAAK,AAAkC,OAAA,GAAG,IAAI;QAAtC,IAAA,OAAO;QAAE,IAAA,MAAM;QAAS,IAAA,KAAK,aAA/B,AAAS,AAAQ,AAAc,AAAS,AAAC;QAC/CA,GAAK,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;QACtCA,GAAK,CAAC,SAAS,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACtDA,GAAK,CAAC,YAAY,GAAG,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,YAAY,EAAE,OAAO,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;QAC3FA,GAAK,CAAC,eAAe,GAAG,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAC7DA,GAAK,CAAC,WAAW,GAAG,UAAU,GAAG,eAAe,GAAG,YAAY,CAAC;QAChEA,GAAK,CAAC,WAAW,GAAG,UAAU,GAAG,YAAY,GAAG,eAAe,CAAC;;QAEhE,IAAI,MAAM,EAAE;YACRA,GAAK,CAAC,UAAU,GAAG,IAAI,GAAG;gBACtB,WAAW,CAAC,EAAE,EAAE,WAAW,CAAC,EAAE;gBAC9B,WAAW,CAAC,EAAE,EAAE,WAAW,CAAC,EAAE;aACjC,CAAC;YACF,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,UAAU,GAAG,UAAU,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;YACrF,MAAM,CAAC,OAAO,CAAC,KAAK,GAAG,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,EAAE,CAAC;YACnF,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SAC7B;;QAED,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SACzB;;QAED,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;KAClB,CAAA;;IAED,iBAAA,YAAY,yBAAA,GAAG;QACXD,sBAAK,CAAC,YAAY,KAAA,CAAC,IAAA,CAAC,CAAC;;QAErBC,GAAK,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7BA,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE;YAC/C,IAAI,EAAE;gBACF,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,OAAO,EAAE,OAAO,CAAC,OAAO;aAC3B;YACD,MAAM,EAAE,IAAI;SACf,CAAC,CAAC;;QAEH,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,EAAE;YAC1B,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE;gBACvB,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK;gBACzC,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK;gBAC3B,QAAQ,EAAE,OAAO,CAAC,MAAM,CAAC,QAAQ;gBACjC,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC;aACnE,CAAC,CAAC;SACN;;QAED,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;;QAEvB,gBAAgB,CAAC,IAAI,CAAC,CAAC;QACvB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KAC5B,CAAA;;IAED,iBAAA,eAAe,4BAAA,GAAG;QACd,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM;gBAClC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS;aAC1C,CAAC;SACL;KACJ,CAAA;;IAED,iBAAA,eAAe,4BAAA,CAAC,KAAK,EAAE;QACnB,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,KAAK,CAAC,CAAC;KACvD,CAAA;;IAED,iBAAA,eAAe,4BAAA,GAAG;QACd,OAAO,IAAI,CAAC,UAAU,CAAC;KAC1B,CAAA;;IAED,iBAAA,mBAAmB,gCAAA,GAAG;QAClB,OAAO;YACH,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;YACvB,MAAM,EAAE,IAAI,CAAC,UAAU;YACvB,OAAO,EAAE,IAAI,CAAC,OAAO;SACxB,CAAC;KACL,CAAA;;IAED,iBAAA,WAAW,wBAAA,CAAC,MAAM,EAAE;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;KACpD,CAAA,AACJ;;;EAvHoB,YAuHpB,GAAA;;AAED,MAAM,CAAC,SAAS,CAAC,aAAa,GAAG,GAAG,CAAC,SAAS,CAAC,aAAa,CAAC;;AAE7D,iBAAiB,CAAC,MAAM,EAAE;IACtB,MAAM,EAAE;QACJ,KAAK,EAAE,CAAC;KACX;IACD,QAAQ,EAAE,KAAK;IACf,OAAO,EAAE,CAAC;IACV,MAAM,EAAE;QACJ,KAAK,EAAE,EAAE;QACT,MAAM,EAAE;YACJ,KAAK,EAAE,CAAC;YACR,KAAK,EAAE,OAAO;SACjB;QACD,IAAI,EAAE;YACF,KAAK,EAAE,CAAC;SACX;KACJ;IACD,OAAO,EAAE;QACL,MAAM,EAAE,+BAA+B;KAC1C;CACJ,CAAC,CAAC;;AAEH,UAAU,CAAC,MAAM,CAAC,SAAS,EAAE,gBAAgB,CAAC,CAAC;AAC/C,UAAU,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;;AAExC,eAAe,MAAM"}