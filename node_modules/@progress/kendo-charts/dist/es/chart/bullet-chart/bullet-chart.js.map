{"version":3,"file":"bullet-chart.js","sources":["bullet-chart.js"],"sourcesContent":["\nimport CategoricalChart from '../categorical-chart';\nimport BarChart from '../bar-chart/bar-chart';\nimport Bullet from './bullet';\nimport ClusterLayout from '../layout/cluster-layout';\nimport { BAR } from '../constants';\n\nimport { MIN_VALUE, MAX_VALUE } from '../../common/constants';\nimport { deepExtend, defined, isArray, isFunction, isObject, setDefaultOptions } from '../../common';\n\nclass BulletChart extends CategoricalChart {\n    constructor(plotArea, options) {\n\n        wrapData(options);\n\n        super(plotArea, options);\n    }\n\n    reflowCategories(categorySlots) {\n        const children = this.children;\n        const childrenLength = children.length;\n\n        for (let i = 0; i < childrenLength; i++) {\n            children[i].reflow(categorySlots[i]);\n        }\n    }\n\n    plotRange(point) {\n        const series = point.series;\n        const valueAxis = this.seriesValueAxis(series);\n        const axisCrossingValue = this.categoryAxisCrossingValue(valueAxis);\n\n        return [ axisCrossingValue, point.value.current || axisCrossingValue ];\n    }\n\n    createPoint(data, fields) {\n        const { categoryIx, category, series, seriesIx } = fields;\n        const { options, children } = this;\n        const value = data.valueFields;\n\n        let bulletOptions = deepExtend({\n            vertical: !options.invertAxes,\n            overlay: series.overlay,\n            categoryIx: categoryIx,\n            invertAxes: options.invertAxes\n        }, series);\n\n        let color = data.fields.color || series.color;\n        bulletOptions = this.evalPointOptions(\n            bulletOptions, value, category, categoryIx, series, seriesIx\n        );\n\n        if (isFunction(series.color)) {\n            color = bulletOptions.color;\n        }\n\n        const bullet = new Bullet(value, bulletOptions);\n        bullet.color = color;\n\n        let cluster = children[categoryIx];\n        if (!cluster) {\n            cluster = new ClusterLayout({\n                vertical: options.invertAxes,\n                gap: options.gap,\n                spacing: options.spacing\n            });\n            this.append(cluster);\n        }\n\n        cluster.append(bullet);\n\n        return bullet;\n    }\n\n    updateRange(value, fields) {\n        const { current, target } = value;\n        const axisName = fields.series.axis;\n        let axisRange = this.valueAxisRanges[axisName];\n\n        if (defined(current) && !isNaN(current) && defined(target && !isNaN(target))) {\n            axisRange = this.valueAxisRanges[axisName] =\n                axisRange || { min: MAX_VALUE, max: MIN_VALUE };\n\n            axisRange.min = Math.min(axisRange.min, current, target);\n            axisRange.max = Math.max(axisRange.max, current, target);\n        }\n    }\n\n    formatPointValue(point, format) {\n        return this.chartService.format.auto(format, point.value.current, point.value.target);\n    }\n\n    pointValue(data) {\n        return data.valueFields.current;\n    }\n\n    aboveAxis(point) {\n        const value = point.value.current;\n\n        return value > 0;\n    }\n\n    createAnimation() {\n        const points = this.points;\n\n        this._setAnimationOptions();\n\n        for (let idx = 0; idx < points.length; idx++) {\n            const point = points[idx];\n            point.options.animation = this.options.animation;\n            point.createAnimation();\n        }\n    }\n}\n\nBulletChart.prototype._setAnimationOptions = BarChart.prototype._setAnimationOptions;\n\nsetDefaultOptions(BulletChart, {\n    animation: {\n        type: BAR\n    }\n});\n\nfunction wrapData(options) {\n    const series = options.series;\n\n    for (let i = 0; i < series.length; i++) {\n        const seriesItem = series[i];\n        const data = seriesItem.data;\n        if (data && !isArray(data[0]) && !isObject(data[0])) {\n            seriesItem.data = [ data ];\n        }\n    }\n}\n\nexport default BulletChart;"],"names":["super","const","let","this"],"mappings":"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"}