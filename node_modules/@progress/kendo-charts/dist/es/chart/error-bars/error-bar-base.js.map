{"version":3,"file":"error-bar-base.js","sources":["error-bar-base.js"],"sourcesContent":["import { drawing as draw } from '@progress/kendo-drawing';\n\nimport { ChartElement, Point, Box } from '../../core';\n\nimport { FADEIN, INITIAL_ANIMATION_DURATION } from '../constants';\n\nimport { setDefaultOptions, alignPathToPixel } from '../../common';\n\nconst DEFAULT_ERROR_BAR_WIDTH = 4;\n\nclass ErrorBarBase extends ChartElement {\n    constructor(low, high, isVertical, chart, series, options) {\n        super(options);\n\n        this.low = low;\n        this.high = high;\n        this.isVertical = isVertical;\n        this.chart = chart;\n        this.series = series;\n    }\n\n    reflow(targetBox) {\n        const endCaps = this.options.endCaps;\n        const isVertical = this.isVertical;\n        const axis = this.getAxis();\n        const valueBox = axis.getSlot(this.low, this.high);\n        const centerBox = targetBox.center();\n        const capsWidth = this.getCapsWidth(targetBox, isVertical);\n        const capValue = isVertical ? centerBox.x : centerBox.y;\n        const capStart = capValue - capsWidth;\n        const capEnd = capValue + capsWidth;\n        let linePoints;\n\n        if (isVertical) {\n            linePoints = [\n                new Point(centerBox.x, valueBox.y1),\n                new Point(centerBox.x, valueBox.y2)\n            ];\n            if (endCaps) {\n                linePoints.push(new Point(capStart, valueBox.y1),\n                    new Point(capEnd, valueBox.y1),\n                    new Point(capStart, valueBox.y2),\n                    new Point(capEnd, valueBox.y2));\n            }\n            this.box = new Box(capStart, valueBox.y1, capEnd, valueBox.y2);\n        } else {\n            linePoints = [\n                new Point(valueBox.x1, centerBox.y),\n                new Point(valueBox.x2, centerBox.y)\n            ];\n            if (endCaps) {\n                linePoints.push(new Point(valueBox.x1, capStart),\n                    new Point(valueBox.x1, capEnd),\n                    new Point(valueBox.x2, capStart),\n                    new Point(valueBox.x2, capEnd));\n            }\n            this.box = new Box(valueBox.x1, capStart, valueBox.x2, capEnd);\n        }\n\n        this.linePoints = linePoints;\n    }\n\n    getCapsWidth(box, isVertical) {\n        const boxSize = isVertical ? box.width() : box.height();\n        const capsWidth = Math.min(Math.floor(boxSize / 2), DEFAULT_ERROR_BAR_WIDTH) || DEFAULT_ERROR_BAR_WIDTH;\n\n        return capsWidth;\n    }\n\n    createVisual() {\n        const options = this.options;\n        const visual = options.visual;\n\n        if (visual) {\n            this.visual = visual({\n                low: this.low,\n                high: this.high,\n                rect: this.box.toRect(),\n                sender: this.getSender(),\n                options: {\n                    endCaps: options.endCaps,\n                    color: options.color,\n                    line: options.line\n                },\n                createVisual: () => {\n                    this.createDefaultVisual();\n                    const defaultVisual = this.visual;\n                    delete this.visual;\n                    return defaultVisual;\n                }\n            });\n        } else {\n            this.createDefaultVisual();\n        }\n    }\n\n    createDefaultVisual() {\n        const { options, linePoints } = this;\n        const lineOptions = {\n            stroke: {\n                color: options.color,\n                width: options.line.width,\n                dashType: options.line.dashType\n            }\n        };\n\n        super.createVisual();\n\n        for (let idx = 0; idx < linePoints.length; idx += 2) {\n            const line = new draw.Path(lineOptions)\n                .moveTo(linePoints[idx].x, linePoints[idx].y)\n                .lineTo(linePoints[idx + 1].x, linePoints[idx + 1].y);\n\n            alignPathToPixel(line);\n            this.visual.append(line);\n        }\n    }\n}\n\nsetDefaultOptions(ErrorBarBase, {\n    animation: {\n        type: FADEIN,\n        delay: INITIAL_ANIMATION_DURATION\n    },\n    endCaps: true,\n    line: {\n        width: 2\n    },\n    zIndex: 1\n});\n\nexport default ErrorBarBase;"],"names":["const","super","let","this"],"mappings":"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"}