{"version":3,"file":"crosshair.js","sources":["crosshair.js"],"sourcesContent":["import { drawing as draw, geometry as geom } from '@progress/kendo-drawing';\n\nimport { ChartElement, CategoryAxis } from '../../core';\nimport CrosshairTooltip from './crosshair-tooltip';\n\nimport { BLACK, X, Y } from '../../common/constants';\nimport { deepExtend, setDefaultOptions } from '../../common';\n\nclass Crosshair extends ChartElement {\n    constructor(chartService, axis, options) {\n        super(options);\n\n        this.axis = axis;\n        this.stickyMode = axis instanceof CategoryAxis;\n\n        const tooltipOptions = this.options.tooltip;\n\n        if (tooltipOptions.visible) {\n            this.tooltip = new CrosshairTooltip(chartService, this,\n                deepExtend({}, tooltipOptions, { stickyMode: this.stickyMode })\n            );\n        }\n    }\n\n    showAt(point) {\n        this.point = point;\n        this.moveLine();\n        this.line.visible(true);\n\n        if (this.tooltip) {\n            this.tooltip.showAt(point);\n        }\n    }\n\n    hide() {\n        this.line.visible(false);\n\n        if (this.tooltip) {\n            this.tooltip.hide();\n        }\n    }\n\n    moveLine() {\n        const { axis, point } = this;\n        const vertical = axis.options.vertical;\n        const box = this.getBox();\n        const dim = vertical ? Y : X;\n        const lineStart = new geom.Point(box.x1, box.y1);\n        let lineEnd;\n\n        if (vertical) {\n            lineEnd = new geom.Point(box.x2, box.y1);\n        } else {\n            lineEnd = new geom.Point(box.x1, box.y2);\n        }\n\n        if (point) {\n            if (this.stickyMode) {\n                const slot = axis.getSlot(axis.pointCategoryIndex(point));\n                lineStart[dim] = lineEnd[dim] = slot.center()[dim];\n            } else {\n                lineStart[dim] = lineEnd[dim] = point[dim];\n            }\n        }\n\n        this.box = box;\n\n        this.line.moveTo(lineStart).lineTo(lineEnd);\n    }\n\n    getBox() {\n        const axis = this.axis;\n        const axes = axis.pane.axes;\n        const length = axes.length;\n        const vertical = axis.options.vertical;\n        const box = axis.lineBox().clone();\n        const dim = vertical ? X : Y;\n        let axisLineBox;\n\n        for (let i = 0; i < length; i++) {\n            const currentAxis = axes[i];\n            if (currentAxis.options.vertical !== vertical) {\n                if (!axisLineBox) {\n                    axisLineBox = currentAxis.lineBox().clone();\n                } else {\n                    axisLineBox.wrap(currentAxis.lineBox());\n                }\n            }\n        }\n\n        box[dim + 1] = axisLineBox[dim + 1];\n        box[dim + 2] = axisLineBox[dim + 2];\n\n        return box;\n    }\n\n    createVisual() {\n        super.createVisual();\n\n        const options = this.options;\n        this.line = new draw.Path({\n            stroke: {\n                color: options.color,\n                width: options.width,\n                opacity: options.opacity,\n                dashType: options.dashType\n            },\n            visible: false\n        });\n\n        this.moveLine();\n        this.visual.append(this.line);\n    }\n\n    destroy() {\n        if (this.tooltip) {\n            this.tooltip.destroy();\n        }\n\n        super.destroy();\n    }\n}\n\nsetDefaultOptions(Crosshair, {\n    color: BLACK,\n    width: 2,\n    zIndex: -1,\n    tooltip: {\n        visible: false\n    }\n});\n\nexport default Crosshair;"],"names":["super","const","let"],"mappings":"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"}