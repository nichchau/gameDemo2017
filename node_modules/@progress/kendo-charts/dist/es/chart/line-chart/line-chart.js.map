{"version":3,"file":"line-chart.js","sources":["line-chart.js"],"sourcesContent":["import CategoricalChart from '../categorical-chart';\nimport LinePoint from './line-point';\nimport LineSegment from './line-segment';\nimport StepLineSegment from './step-line-segment';\nimport SplineSegment from './spline-segment';\nimport LineChartMixin from '../mixins/line-chart-mixin';\nimport ClipAnimationMixin from '../mixins/clip-animation-mixin';\n\nimport { ZERO, SMOOTH, STEP } from '../constants';\n\nimport { deepExtend, defined, isFunction } from '../../common';\n\nclass LineChart extends CategoricalChart {\n    render() {\n\n        super.render();\n\n        this.updateStackRange();\n        this.renderSegments();\n    }\n\n    pointType() {\n        return LinePoint;\n    }\n\n    createPoint(data, fields) {\n        const { categoryIx, category, series, seriesIx } = fields;\n        const missingValues = this.seriesMissingValues(series);\n        let value = data.valueFields.value;\n\n        if (!defined(value) || value === null) {\n            if (missingValues === ZERO) {\n                value = 0;\n            } else {\n                return null;\n            }\n        }\n\n        let pointOptions = this.pointOptions(series, seriesIx);\n        pointOptions = this.evalPointOptions(\n            pointOptions, value, category, categoryIx, series, seriesIx\n        );\n\n        let color = data.fields.color || series.color;\n        if (isFunction(series.color)) {\n            color = pointOptions.color;\n        }\n\n        const point = new LinePoint(value, pointOptions);\n        point.color = color;\n\n        this.append(point);\n\n        return point;\n    }\n\n    plotRange(point) {\n        let plotValue = this.plotValue(point);\n\n        if (this.options.isStacked) {\n            const categoryIx = point.categoryIx;\n            const categoryPoints = this.categoryPoints[categoryIx];\n\n            for (let i = 0; i < categoryPoints.length; i++) {\n                const other = categoryPoints[i];\n\n                if (point === other) {\n                    break;\n                }\n\n                plotValue += this.plotValue(other);\n\n                if (this.options.isStacked100) {\n                    plotValue = Math.min(plotValue, 1);\n                }\n            }\n\n        }\n\n        return [ plotValue, plotValue ];\n    }\n\n    createSegment(linePoints, currentSeries, seriesIx) {\n        const style = currentSeries.style;\n        let pointType;\n\n        if (style === STEP) {\n            pointType = StepLineSegment;\n        } else if (style === SMOOTH) {\n            pointType = SplineSegment;\n        } else {\n            pointType = LineSegment;\n        }\n\n        return new pointType(linePoints, currentSeries, seriesIx);\n    }\n\n    animationPoints() {\n        const points = this.points;\n        const result = [];\n        for (let idx = 0; idx < points.length; idx++) {\n            result.push((points[idx] || {}).marker);\n        }\n        return result.concat(this._segments);\n    }\n}\n\ndeepExtend(LineChart.prototype, LineChartMixin, ClipAnimationMixin);\n\nexport default LineChart;"],"names":["super","const","let","this"],"mappings":"AAAA,OAAO,gBAAgB,MAAM,sBAAsB,CAAC;AACpD,OAAO,SAAS,MAAM,cAAc,CAAC;AACrC,OAAO,WAAW,MAAM,gBAAgB,CAAC;AACzC,OAAO,eAAe,MAAM,qBAAqB,CAAC;AAClD,OAAO,aAAa,MAAM,kBAAkB,CAAC;AAC7C,OAAO,cAAc,MAAM,4BAA4B,CAAC;AACxD,OAAO,kBAAkB,MAAM,gCAAgC,CAAC;;AAEhE,SAAS,IAAI,EAAE,MAAM,EAAE,IAAI,QAAQ,cAAc,CAAC;;AAElD,SAAS,UAAU,EAAE,OAAO,EAAE,UAAU,QAAQ,cAAc,CAAC;;AAE/D,IAAM,SAAS,GAAyB;IAAC;;;;;;;;IAAA,AACrC,oBAAA,MAAM,mBAAA,GAAG;;QAELA,0BAAK,CAAC,MAAM,KAAA,CAAC,IAAA,CAAC,CAAC;;QAEf,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,cAAc,EAAE,CAAC;KACzB,CAAA;;IAED,oBAAA,SAAS,sBAAA,GAAG;QACR,OAAO,SAAS,CAAC;KACpB,CAAA;;IAED,oBAAA,WAAW,wBAAA,CAAC,IAAI,EAAE,MAAM,EAAE;QACtB,AAAK,AAAG,IAAA,UAAU;QAAE,IAAA,QAAQ;QAAE,IAAA,MAAM;QAAE,IAAA,QAAQ,mBAAxC,AAAY,AAAU,AAAQ,AAAU,AAAE,AAAS,AAAC;QAC1DC,GAAK,CAAC,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QACvDC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;;QAEnC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,KAAK,IAAI,EAAE;YACnC,IAAI,aAAa,KAAK,IAAI,EAAE;gBACxB,KAAK,GAAG,CAAC,CAAC;aACb,MAAM;gBACH,OAAO,IAAI,CAAC;aACf;SACJ;;QAEDA,GAAG,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QACvD,YAAY,GAAG,IAAI,CAAC,gBAAgB;YAChC,YAAY,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ;SAC9D,CAAC;;QAEFA,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC;QAC9C,IAAI,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;YAC1B,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC;SAC9B;;QAEDD,GAAK,CAAC,KAAK,GAAG,IAAI,SAAS,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;QACjD,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;;QAEpB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;;QAEnB,OAAO,KAAK,CAAC;KAChB,CAAA;;IAED,oBAAA,SAAS,sBAAA,CAAC,KAAK,EAAE,CAAC;;AAAA;QACdC,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;QAEtC,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;YACxBD,GAAK,CAAC,UAAU,GAAG,KAAK,CAAC,UAAU,CAAC;YACpCA,GAAK,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;;YAEvD,KAAKC,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC5CD,GAAK,CAAC,KAAK,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC;;gBAEhC,IAAI,KAAK,KAAK,KAAK,EAAE;oBACjB,MAAM;iBACT;;gBAED,SAAS,IAAIE,MAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;gBAEnC,IAAIA,MAAI,CAAC,OAAO,CAAC,YAAY,EAAE;oBAC3B,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;iBACtC;aACJ;;SAEJ;;QAED,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC;KACnC,CAAA;;IAED,oBAAA,aAAa,0BAAA,CAAC,UAAU,EAAE,aAAa,EAAE,QAAQ,EAAE;QAC/CF,GAAK,CAAC,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;QAClCC,GAAG,CAAC,SAAS,CAAC;;QAEd,IAAI,KAAK,KAAK,IAAI,EAAE;YAChB,SAAS,GAAG,eAAe,CAAC;SAC/B,MAAM,IAAI,KAAK,KAAK,MAAM,EAAE;YACzB,SAAS,GAAG,aAAa,CAAC;SAC7B,MAAM;YACH,SAAS,GAAG,WAAW,CAAC;SAC3B;;QAED,OAAO,IAAI,SAAS,CAAC,UAAU,EAAE,aAAa,EAAE,QAAQ,CAAC,CAAC;KAC7D,CAAA;;IAED,oBAAA,eAAe,4BAAA,GAAG;QACdD,GAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3BA,GAAK,CAAC,MAAM,GAAG,EAAE,CAAC;QAClB,KAAKC,GAAG,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,MAAM,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;YAC1C,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;SAC3C;QACD,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KACxC,CAAA,AACJ;;;EA7FuB,gBA6FvB,GAAA;;AAED,UAAU,CAAC,SAAS,CAAC,SAAS,EAAE,cAAc,EAAE,kBAAkB,CAAC,CAAC;;AAEpE,eAAe,SAAS"}