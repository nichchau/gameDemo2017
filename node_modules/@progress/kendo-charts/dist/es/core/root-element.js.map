{"version":3,"file":"root-element.js","sources":["root-element.js"],"sourcesContent":["import { drawing as draw } from '@progress/kendo-drawing';\n\nimport ChartElement from './chart-element';\nimport GRADIENTS from './gradients';\nimport Box from './box';\n\nimport boxDiff from './utils/box-diff';\n\nimport { DEFAULT_WIDTH, DEFAULT_HEIGHT, WHITE, BLACK } from '../common/constants';\nimport { getSpacing, objectKey, setDefaultOptions } from '../common';\n\nclass RootElement extends ChartElement {\n    constructor(options) {\n        super(options);\n\n        const rootOptions = this.options;\n        rootOptions.width = parseInt(rootOptions.width, 10);\n        rootOptions.height = parseInt(rootOptions.height, 10);\n\n        this.gradients = {};\n    }\n\n    reflow() {\n        const { options, children } = this;\n        let currentBox = new Box(0, 0, options.width, options.height);\n\n        this.box = currentBox.unpad(options.margin);\n\n        for (let i = 0; i < children.length; i++) {\n            children[i].reflow(currentBox);\n            currentBox = boxDiff(currentBox, children[i].box) || new Box();\n        }\n    }\n\n    createVisual() {\n        this.visual = new draw.Group();\n        this.createBackground();\n    }\n\n    createBackground() {\n        const options = this.options;\n        const border = options.border || {};\n        const box = this.box.clone().pad(options.margin).unpad(border.width);\n\n        const background = draw.Path.fromRect(box.toRect(), {\n            stroke: {\n                color: border.width ? border.color : \"\",\n                width: border.width,\n                dashType: border.dashType\n            },\n            fill: {\n                color: options.background,\n                opacity: options.opacity\n            },\n            zIndex: -10\n        });\n\n        this.visual.append(background);\n    }\n\n    getRoot() {\n        return this;\n    }\n\n    createGradient(options) {\n        const gradients = this.gradients;\n        const hashCode = objectKey(options);\n        const gradient = GRADIENTS[options.gradient];\n        let drawingGradient;\n\n        if (gradients[hashCode]) {\n            drawingGradient = gradients[hashCode];\n        } else {\n            const gradientOptions = Object.assign({}, gradient, options);\n            if (gradient.type === \"linear\") {\n                drawingGradient = new draw.LinearGradient(gradientOptions);\n            } else {\n                if (options.innerRadius) {\n                    gradientOptions.stops = innerRadialStops(gradientOptions);\n                }\n                drawingGradient = new draw.RadialGradient(gradientOptions);\n                drawingGradient.supportVML = gradient.supportVML !== false;\n            }\n            gradients[hashCode] = drawingGradient;\n        }\n\n        return drawingGradient;\n    }\n}\n\nsetDefaultOptions(RootElement, {\n    width: DEFAULT_WIDTH,\n    height: DEFAULT_HEIGHT,\n    background: WHITE,\n    border: {\n        color: BLACK,\n        width: 0\n    },\n    margin: getSpacing(5),\n    zIndex: -2\n});\n\nfunction innerRadialStops(options) {\n    const stops = options.stops;\n    const usedSpace = ((options.innerRadius / options.radius) * 100);\n    const length = stops.length;\n    const currentStops = [];\n\n    for (let i = 0; i < length; i++) {\n        let currentStop = Object.assign({}, stops[i]);\n        currentStop.offset = (currentStop.offset * (100 - usedSpace) + usedSpace) / 100;\n        currentStops.push(currentStop);\n    }\n\n    return currentStops;\n}\n\nexport default RootElement;"],"names":["super","const","let"],"mappings":"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"}