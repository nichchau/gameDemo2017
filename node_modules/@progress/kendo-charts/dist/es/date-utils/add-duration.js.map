{"version":3,"file":"add-duration.js","sources":["add-duration.js"],"sourcesContent":["import { MILLISECONDS, SECONDS, MINUTES, HOURS, DAYS, WEEKS, MONTHS, YEARS,\n    TIME_PER_SECOND, TIME_PER_MINUTE, TIME_PER_HOUR } from './constants';\nimport addTicks from './add-ticks';\nimport toDate from './to-date';\nimport startOfWeek from './start-of-week';\n\nfunction adjustDST(date, hours) {\n    if (hours === 0 && date.getHours() === 23) {\n        date.setHours(date.getHours() + 2);\n        return true;\n    }\n\n    return false;\n}\n\nfunction addHours(date, hours) {\n    const roundedDate = new Date(date);\n\n    roundedDate.setMinutes(0, 0, 0);\n\n    const tzDiff = (date.getTimezoneOffset() - roundedDate.getTimezoneOffset()) * TIME_PER_MINUTE;\n\n    return addTicks(roundedDate, tzDiff + hours * TIME_PER_HOUR);\n}\n\nexport default function addDuration(dateValue, value, unit, weekStartDay) {\n    let result = dateValue;\n\n    if (dateValue) {\n        let date = toDate(dateValue);\n        const hours = date.getHours();\n\n        if (unit === YEARS) {\n            result = new Date(date.getFullYear() + value, 0, 1);\n            adjustDST(result, 0);\n        } else if (unit === MONTHS) {\n            result = new Date(date.getFullYear(), date.getMonth() + value, 1);\n            adjustDST(result, hours);\n        } else if (unit === WEEKS) {\n            result = addDuration(startOfWeek(date, weekStartDay), value * 7, DAYS);\n            adjustDST(result, hours);\n        } else if (unit === DAYS) {\n            result = new Date(date.getFullYear(), date.getMonth(), date.getDate() + value);\n            adjustDST(result, hours);\n        } else if (unit === HOURS) {\n            result = addHours(date, value);\n        } else if (unit === MINUTES) {\n            result = addTicks(date, value * TIME_PER_MINUTE);\n\n            if (result.getSeconds() > 0) {\n                result.setSeconds(0);\n            }\n        } else if (unit === SECONDS) {\n            result = addTicks(date, value * TIME_PER_SECOND);\n        } else if (unit === MILLISECONDS) {\n            result = addTicks(date, value);\n        }\n\n        if (unit !== MILLISECONDS && result.getMilliseconds() > 0) {\n            result.setMilliseconds(0);\n        }\n    }\n\n    return result;\n}"],"names":["const","let"],"mappings":"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"}